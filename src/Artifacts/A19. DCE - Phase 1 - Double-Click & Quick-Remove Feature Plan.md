# Artifact A19: DCE - Phase 1 - Double-Click & Quick-Remove Feature Plan
# Date Created: Cycle 26
# Author: AI Model

- **Key/Value for A0:**
- **Description:** Details the requirements for opening files by double-clicking them and quickly removing single files from the selection list via a mouse-over action.
- **Tags:** feature plan, double-click, open file, quick remove, ux, phase 1

## 1. Overview & Goal

To further align the Data Curation Environment with standard, intuitive user workflows, this plan introduces two high-impact interaction enhancements. The first is the ability to double-click any file to open it in the main editor. The second is a "quick-remove" feature in the "Selected Items" panel, allowing for rapid, single-click removal of files. The goal is to reduce friction and increase the speed at which a user can curate their context.

## 2. User Stories

| ID | User Story | Acceptance Criteria |
|---|---|---|
| UX-01 | **Double-Click to Open (Main Tree)** | As a user, I want to be able to double-click on a file in the main "Data Curation" file tree and have it open in the editor, so I can quickly view its contents. | - Double-clicking a file item (not a folder) in the main file tree opens that file in the main VS Code editor pane. <br> - If the file is already open in a tab, the editor switches focus to that tab. <br> - A single click on a file still sets it as the "active" file for highlighting purposes, without opening it. |
| UX-02 | **Double-Click to Open (Selected List)** | As a user, I want to double-click a file in the "Selected Items" list to open it, so I can easily inspect the files that are contributing the most tokens to my context. | - Double-clicking a file item in the "Selected Items" list opens that file in the main VS Code editor pane. <br> - If the file is already open, focus is switched to its tab. |
| UX-03 | **Quick Remove from Selection** | As a user, after selecting a large folder, I want to quickly remove a single file from the "Selected Items" list with one click, so I don't have to select it and then click the "Remove Selected" button. | - In the "Selected Items" list, when I mouse over a file row, the row number (in the `#` column) is replaced by an 'X' icon. <br> - Clicking the 'X' icon immediately removes that single file from the selection. <br> - This action is equivalent to selecting only that file and clicking "Remove Selected". <br> - The mouse leaving the row restores the row number. |

## 3. Technical Implementation Plan

1.  **IPC Channel (`channels.enum.ts`, `channels.type.ts`):**
    *   Create a new `ClientToServerChannel`: `RequestOpenFile`.
    *   The `ChannelBody` will be `{ path: string }`.

2.  **Backend Handler (`on-message.ts`, `fs.service.ts`):**
    *   Add a new case in `on-message.ts` to listen for `RequestOpenFile` and call a new method in `FSService`.
    *   Create `handleOpenFileRequest(path: string)` in `fs.service.ts`.
    *   This method will create a `vscode.Uri` from the file path, then use `vscode.workspace.openTextDocument(uri)` followed by `vscode.window.showTextDocument(doc)`.

3.  **Frontend - Double-Click (`TreeView.tsx`, `SelectedFilesView.tsx`):**
    *   In `TreeView.tsx`, add an `onDoubleClick` handler to the `<li>` element that wraps a file node. The handler will check if the node is a file (not a directory) and then call `clientIpc.sendToServer(ClientToServerChannel.RequestOpenFile, { path: node.absolutePath })`.
    *   In `SelectedFilesView.tsx`, add an `onDoubleClick` handler to the `<li>` for each file, which will perform the same IPC call.

4.  **Frontend - Quick Remove (`SelectedFilesView.tsx`, `view.scss`):**
    *   **State:** Add a new state variable to track the hovered item's path: `const [hoveredPath, setHoveredPath] = useState<string | null>(null);`.
    *   **Event Handlers:** Add `onMouseEnter={() => setHoveredPath(node.absolutePath)}` and `onMouseLeave={() => setHoveredPath(null)}` to the `<li>` element.
    *   **Conditional Rendering:** In the JSX for the index column, render conditionally:
        ```jsx
        <span className="file-index">
          {hoveredPath === node.absolutePath ? (
            <span className="quick-remove" onClick={(e) => { e.stopPropagation(); onRemove([node.absolutePath]); }}>
              <VscClose />
            </span>
          ) : (
            index + 1
          )}
        </span>
        ```
    *   **Styling:** Add styles for the `.quick-remove` class in `view.scss` to ensure it's clickable and has appropriate hover effects.
    *   The `onClick` handler will call the existing `onRemove` prop and use `stopPropagation` to prevent the click from also selecting the row.