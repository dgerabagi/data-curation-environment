# Artifact A52.3: DCE - Harmony Interaction Schema Source
# Date Created: C49
# Author: AI Model & Curator
# Updated on: C51 (Migrate to JSON Output Schema)

- **Key/Value for A0:**
- **Description:** The canonical source text for the M3. Interaction Schema, adapted for use with Harmony-based models like GPT-OSS. This version is injected into prompts when "Demo Mode" is active and instructs the model to produce a structured JSON output.
- **Tags:** documentation, process, interaction schema, source of truth, harmony, gpt-oss, json

## Interaction Schema Text

1.  **CRITICAL: Your entire response must be a single, valid JSON object.** Do not include any text before or after the JSON structure. The extension will parse your output using `JSON.parse()`.

2.  **JSON Schema:** Your output must conform to the following TypeScript interface:
    ```typescript
    interface HarmonyFile {
      path: string;      // Relative path to the file from the workspace root.
      content: string;   // The complete and full content of the file.
    }

    interface CourseOfActionStep {
      step: number;
      description: string; // A description of the action for this step.
    }

    interface HarmonyJsonResponse {
      summary: string;
      course_of_action: CourseOfActionStep[];
      curator_activity?: string; // Optional: For instructions to the human.
      files: HarmonyFile[];
    }
    ```

3.  **Example Output:**
    ```json
    {
      "summary": "I have analyzed the request and will update the main application component and its corresponding service.",
      "course_of_action": [
        {
          "step": 1,
          "description": "Update `src/App.tsx`: Add a new state variable and a button to trigger the new functionality."
        },
        {
          "step": 2,
          "description": "Update `src/services/api.ts`: Create a new function to fetch the required data from the backend."
        }
      ],
      "curator_activity": "Please ensure the backend API endpoint `GET /api/newdata` is running and accessible.",
      "files": [
        {
          "path": "src/App.tsx",
          "content": "// Full content of the updated App.tsx file..."
        },
        {
          "path": "src/services/api.ts",
          "content": "// Full content of the updated api.ts file..."
        }
      ]
    }
    ```

4.  **Content Rules:**
    *   Always output complete files. Do not use placeholders or omit code.
    *   Update documentation artifacts before updating code artifacts.
    *   If you need the human curator to perform an action (e.g., delete a file, run a command), describe it in the optional `curator_activity` field.

5.  Our Document Artifacts serve as our `Source of Truth`. As issues occur, or code repeatedly regresses, seek to align our `Source of Truth` documents to codify the root cause and prevent future regressions.

6.  If you are deciding where to place a new function, and multiple files are suitable candidates, choose the smaller file (in tokens).