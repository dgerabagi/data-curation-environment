# Artifact A73: DCE - GitService Plan
# Date Created: C175
# Author: AI Model & Curator

- **Key/Value for A0:**
- **Description:** A plan for a dedicated backend service to encapsulate all interactions with the Git command line for features like baselining and restoring.
- **Tags:** plan, architecture, backend, git, service

## 1. Overview & Goal

To implement the Git-integrated testing workflow (`A70`), we need a dedicated backend component to handle the execution of Git commands. The goal is to create a new, single-responsibility `GitService` that encapsulates all interactions with the Git CLI. This improves modularity and makes the code easier to maintain and test.

## 2. Service Responsibilities

The `GitService` will be responsible for:
-   Executing `git` commands in the user's workspace directory using Node.js's `child_process`.
-   Parsing the output (stdout and stderr) of Git commands.
-   Handling errors gracefully and providing clear feedback to the user.

## 3. Technical Implementation Plan

1.  **New File (`src/backend/services/git.service.ts`):**
    *   Create the new service file.
    *   It will import `exec` from `child_process` and `vscode`.

2.  **Core `execGitCommand` Method:**
    *   A private helper method will be the foundation of the service: `private execGitCommand(command: string): Promise<{ stdout: string; stderr: string }>`.
    *   This method will wrap the `exec` call in a `Promise`, making it easy to use with `async/await`.
    *   It will get the workspace root path from `vscode.workspace.workspaceFolders`.
    *   It will execute the command within that workspace directory.

3.  **Public Handler Methods:**
    *   **`handleGitBaselineRequest(commitMessage: string)`:**
        *   Calls `await this.execGitCommand('git add .')`.
        *   On success, calls `await this.execGitCommand(\`git commit -m "${commitMessage}"\`)`.
        *   Will show a `vscode.window.showInformationMessage` on success or `showErrorMessage` on failure.
    *   **`handleGitRestoreRequest()`:**
        *   Constructs the command: `git restore -- . ':(exclude).vscode/dce_history.json'`.
        *   Calls `await this.execGitCommand(...)`.
        *   Shows appropriate success or error messages to the user.

4.  **Integration:**
    *   The new `GitService` will be instantiated in `src/backend/services/services.ts`.
    *   The `parallel-copilot.view/on-message.ts` file will be updated to call the new service's methods when it receives the `RequestGitBaseline` and `RequestGitRestore` IPC messages.