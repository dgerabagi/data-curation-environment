# Artifact A34: DCE - Phase 2 - Parallel Co-Pilot Panel - Vision & Requirements
# Date Created: C69
# Author: AI Model
# Updated on: C88 (Add metadata display requirements)

- **Key/Value for A0:**
- **Description:** Outlines the high-level vision and user stories for the Phase 2 multi-tabbed editor panel, designed for comparing and managing multiple AI-generated responses. Includes plans for response annotation and a "Cycles Context" field.
- **Tags:** feature plan, phase 2, co-pilot, multi-tab, ui, ux, requirements, annotation, persistence, diff

## 1. Vision & Goal

Phase 2 of the Data Curation Environment aims to solve the "single-threaded" nature of interacting with AI assistants. The current workflow for developers often involves sending the same prompt to multiple models or conversations, copying the results to separate text files, and then manually integrating them into their project to test. This is inefficient and cumbersome.

The goal of the **Parallel Co-Pilot Panel** is to create an integrated, **persistent** environment within VS Code specifically for managing, comparing, diffing, and testing multiple AI-generated code responses. It will function as a temporary "workbench" for AI outputs before they are committed to the source code.

**Architectural Vision (C75 Update):** The Parallel Co-Pilot will be a top-level view, accessible via its own icon in the VS Code Activity Bar. It will **not** be a sub-panel within the "Data Curation" file tree view. This provides a larger, dedicated space for comparing responses, aligning with its role as a primary workflow tool.

## 2. Core Concepts

1.  **Dedicated View Container:** The panel has its own icon in the Activity Bar, providing a distinct, full-height space for its UI.
2.  **Stateful & Persistent:** The content of all tabs, context fields, and the current cycle number are automatically saved. The state persists across sessions and when moving the panel to a new window.
3.  **Multi-Tab Editor:** A multi-tabbed text editor interface for managing multiple AI responses.
4.  **Live Testing via "Swap":** The core innovation is a "swap" feature. The user can, with a single click, exchange the content of a tab with its corresponding source file in the workspace.
5.  **Integrated Diffing:** Users can click on a file detected in a response to see an immediate diff view comparing the AI's suggestion against the current workspace file.
6.  **Cycle Navigator:** A UI to navigate back and forth through the history of development cycles, loading the corresponding AI responses for each cycle.
7.  **Metadata Display:** Each response tab will display key metadata, such as token counts and similarity scores, to help the user quickly evaluate the AI's output.

## 3. User Stories

| ID | User Story | Acceptance Criteria |
|---|---|---|
| P2-US-01 | **Manage Multiple Responses** | As a developer, I want a dedicated panel with multiple tabs where I can place different AI-generated code responses, so I can keep them organized. | - A new icon in the Activity Bar opens the Parallel Co-Pilot panel. <br> - The panel contains a slider or input to select the number of visible tabs. <br> - Each tab is a fully functional text editor with syntax highlighting. |
| P2-US-02 | **Persistent State** | As a developer, I want all the text I've entered into the panel (response tabs, context fields) to be saved automatically, so I don't lose my work if I close the panel, move it, or restart VS Code. | - All text content is saved to a history file (`.vscode/dce_history.json`). <br> - When the panel is reopened, it loads the state from the most recent cycle. <br> - Moving the panel into a new window preserves its state. |
| P2-US-03 | **Test Response with "Swap"** | As a developer, I want to click a button to temporarily swap the code from a tab with the actual source file in my project, so I can immediately see if the new code works. | - Each tab has a "Swap with Source" button. <br> - Clicking it replaces the content of the source file on disk with the content of the tab. <br> - Simultaneously, the original content of the source file is loaded into the tab. |
| P2-US-04 | **Review Changes with Diff** | As a developer, I want to see a list of files affected by an AI response and click on any of them to see a diff, so I can review the exact changes before testing. | - The panel parses responses and lists all detected file paths. <br> - A checkmark appears next to files that exist in the workspace. <br> - Clicking a file path opens a diff view (e.g., in a modal) comparing the workspace version with the AI's version. |
| P2-US-05 | **Navigate Cycle History** | As a developer, I want to navigate backward and forward through my project's development cycles, so I can review past AI suggestions. | - UI controls exist to move between cycles. <br> - Navigating to a past cycle loads its saved responses and context into the panel. <br> - The navigator starts at Cycle 1 and cannot go past the latest cycle containing data. |
| P2-US-06 | **Manage Temporary Context** | As a developer, I want separate text areas for "Cycle Context" (long-term notes) and "Ephemeral Context" (temporary logs), so I can manage my prompt inputs effectively. | - Two dedicated, multi-line text input fields are present in the UI. <br> - Their content is saved and restored with the cycle data. |
| P2-US-07 | **View Response Metadata** | As a developer, I want to see key metrics like token counts and similarity scores for each response, so I can quickly compare and evaluate the AI's outputs. | - A dedicated area in each tab displays the total token count of the response. <br> - It also shows a similarity score comparing the response to the original source file. |