# Artifact A34: DCE - Phase 2 - Parallel Co-Pilot Panel - Vision & Requirements
# Date Created: C69
# Author: AI Model
# Updated on: C90 (Add Markdown rendering and collapsible sections)

- **Key/Value for A0:**
- **Description:** Outlines the high-level vision and user stories for the Phase 2 multi-tabbed editor panel, designed for comparing and managing multiple AI-generated responses. Includes plans for response annotation and a "Cycles Context" field.
- **Tags:** feature plan, phase 2, co-pilot, multi-tab, ui, ux, requirements, annotation, persistence, diff, parsing

## 1. Vision & Goal

Phase 2 of the Data Curation Environment aims to solve the "single-threaded" nature of interacting with AI assistants. The current workflow for developers often involves sending the same prompt to multiple models or conversations, copying the results to separate text files, and then manually integrating them into their project to test. This is inefficient and cumbersome.

The goal of the **Parallel Co-Pilot Panel** is to create an integrated, **persistent** environment within VS Code specifically for managing, comparing, diffing, and testing multiple AI-generated code responses.

**Core Workflow (C89 Update):** The primary interaction model is now **parse-centric**. The user pastes a raw, complete AI response into a simple text area. The extension then parses this raw text into a structured, read-only view, separating the AI's plan from its code artifacts. This transforms the panel from a simple text editor into an intelligent review and analysis tool.

## 2. Core Concepts

1.  **Dedicated View Container:** The panel has its own icon in the Activity Bar, providing a distinct, full-height space for its UI.
2.  **Stateful & Persistent:** The content of all tabs, context fields, and the current cycle number are automatically saved. The state persists across sessions and when moving the panel to a new window.
3.  **Parse-on-Demand:** Each tab starts as a simple `textarea`. After the user pastes a response, a "Parse Response" button processes the raw text.
4.  **Structured, Readable View:** After parsing, the `textarea` is replaced by a static, read-only view that:
    *   Renders the AI's summary and plan as **formatted Markdown**.
    *   Uses **collapsible sections** for the main UI areas (Cycle Info, Summary, etc.) to manage screen real estate.
    *   Displays individual, **syntax-highlighted** code blocks for each file.
5.  **Live Testing via "Swap":** The core innovation is a "swap" feature. The user can, with a single click, exchange the content of a parsed file block with its corresponding source file in the workspace.
6.  **Integrated Diffing:** Users can click on a file detected in a response to see an immediate diff view comparing the AI's suggestion against the current workspace file.
7.  **Cycle Navigator:** A UI to navigate back and forth through the history of development cycles, loading the corresponding AI responses for each cycle.
8.  **Metadata Display:** Each response tab will display key metadata, such as token counts and similarity scores, to help the user quickly evaluate the AI's output.

## 3. User Stories

| ID | User Story | Acceptance Criteria |
|---|---|---|
| P2-US-01 | **Manage Multiple Responses** | As a developer, I want a dedicated panel with multiple tabs where I can place different AI-generated code responses, so I can keep them organized. | - A new icon in the Activity Bar opens the Parallel Co-Pilot panel. <br> - The panel contains a slider or input to select the number of visible tabs. <br> - Each tab initially contains a large text input area. |
| P2-US-02 | **Parse Raw Responses** | As a developer, after pasting an AI response, I want to click a button to parse it into a structured view, so I can easily distinguish between the AI's plan and the code it produced. | - Each tab has a "Parse Response" button. <br> - Clicking it processes the raw text. <br> - The UI transforms to show distinct, labeled sections for the AI's summary, course of action, and individual file blocks. |
| P2-US-03 | **View Formatted Text** | As a developer, I want the AI's summary and plan to be rendered as formatted Markdown, so I can easily read lists, bolded text, and other formatting. | - The summary and course of action sections correctly render Markdown syntax (headers, lists, bold, inline code, etc.). |
| P2-US-04 | **Manage UI Space** | As a developer, I want to be able to collapse the main sections of the UI (like the cycle context area or the summary), so I can focus on the code blocks without excessive scrolling. | - The Cycle Info, Summary, and Course of Action sections have headers with chevrons. <br> - Clicking a section header collapses or expands its content. <br> - The collapsed state is managed independently for each section. |
| P2-US-05 | **Persistent State** | As a developer, I want all the text I've entered into the panel (response tabs, context fields) to be saved automatically, so I don't lose my work if I close the panel, move it, or restart VS Code. | - All raw text content is saved to a history file (`.vscode/dce_history.json`). <br> - When the panel is reopened, it loads the state from the most recent cycle. |
| P2-US-06 | **Review Changes with Diff** | As a developer, I want to see a list of files affected by an AI response and click on any of them to see a diff, so I can review the exact changes before testing. | - The parsed view lists all detected file paths. <br> - A checkmark appears next to files that exist in the workspace. <br> - Clicking a file path opens a diff view comparing the workspace version with the AI's version. |
| P2-US-07 | **Navigate Cycle History** | As a developer, I want to navigate backward and forward through my project's development cycles, so I can review past AI suggestions. | - UI controls exist to move between cycles. <br> - Navigating to a past cycle loads its saved raw responses into the panel. |