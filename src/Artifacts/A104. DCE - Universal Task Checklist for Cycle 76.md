# Artifact A104: DCE - Universal Task Checklist for Cycle 76
# Date Created: C76
# Author: AI Model & Curator

## 1. Purpose

This artifact provides a structured checklist for tracking the development tasks, feedback, and bugs identified in Cycle 76. It organizes the work by logical feature area and the group of files involved in each task to help plan and prioritize development.

---

## Task List for Cycle 76+

## T-1: Fix Critical Workflow Blockers
- **Files Involved:**
    - `src/client/views/parallel-copilot.view/view.tsx`
    - `src/backend/services/history.service.ts`
    - `src/common/ipc/channels.type.ts`
    - `src/client/views/parallel-copilot.view/on-message.ts`
- **Total Tokens:** ~17,000
- **More than one cycle?** No
- **Status:** To Do

- [ ] **Task (T-ID: 1.1):** Fix UI navigation failure. Re-implement the logic where the backend returns `newMaxCycle` and the frontend updates its `maxCycle` state *before* navigating to the new cycle.
- [ ] **Task (T-ID: 1.2):** Allow viewing of completed responses. Modify the render logic in `view.tsx` to show the `ResponsePane` for an active tab if its content is complete, even if the overall cycle `status` is still 'generating'.
- [ ] **Task (T-ID: 1.3):** Fix single-tab regeneration in the main view. The `onRegenerateTab` handler must switch the view back to the `GenerationProgressDisplay` for the regenerating tab.

### Verification Steps
1.  In Demo Mode, start a new project, and generate initial responses.
Action taken: 
created new project directory: `TowerDefense54`
switched to `Demo Mode`
wrote `i want to create a tower defense game` in the `Project Scope` on the onboarding page, then clicked `Generate Initial Responses`
Observation:
the spinning animation for all response tabs spinning correctly for the first time. everything seems fine at this time. all four responses streamed in.
2.  In Cycle 1, add context and click `Generate responses`.
Action taken:
selected the longest response, selected all the files in that response, and accepted the selection of 5 files into my workspace.
wrote `now lets build the files from the scaffolding plan` in the `Cycle Context`
set the `Cycle Title` to `create code files`, and the clicked `Generate responses`
3.  **Expected:** The UI should automatically navigate to the new Cycle 2 and display the generation progress UI.
Observation:
the UI did -not- automatically navigate to the new Cycle 2. I have to click `>` which i observed changed from gray to white once i clicked `Generate responses`.
the content of the responses is not aligned with my request in Cycle 1. this is because of the aforementioned failure to properly package the prompt.md prior to sending it.
4.  While responses are generating, click on a tab for a response that has already completed.
Observation:
this works as expected, when i select a completed response tab, i can see that response in view and begin interpreting it.
5.  **Expected:** The view should switch from the progress display to the `ResponsePane` for that completed response.
6.  After all responses are complete, select a tab and click the per-tab "Regenerate" button.
Action taken:
clicked on the response 1 tab regenerate button.
Observation:
the response 1 tab correctly switched to the response ui, however i also observe the spinning animation appear for all tabs, not just the one that i selected the re-generate for. upon checking, the other responses didnt actually re-generate, just the spinner triggered. only the one i clicked on actually regenerated.

i did a further test by attempting to refresh response 2, and what happened was the response 1 tab showed the ui, and it indicated that it was response 1 that was being regenerated, despite my having clicked re-generate for response 2. it does seem that it was response 2 that did end up getting updated, hwoever, so functionally its working, visually we're misaligned.

i ran one more test of the same, this time i regenerated response 3. i checked the token count of both response 1 and response 3 before clicking regenerate for repsonse 3 and i can confirm that when it finished, it was response 3 that was updated... hwoever this time resopnse 1 never came back, so i essentially lost my response 1 in the process of re-generating response 3. so mayby not fully functional, but very very close.

7.  **Expected:** The view for that tab should switch back to the progress display to show the new response streaming in.
Observation: the response ui only seems to appear in response 1 tab despite regenerating some other tab(s). additionally, i am unable to refresh tabs in parallel or simultaneously. while observing vllm, i can see that i ahve to wait for the current req to finish before i can initate a second one. i should be able to batch them easily as a user by simply clicking regenerate on whichever responses i want to regenerate.

## T-2: Implement and Refine Response UI Features
- **Files Involved:**
    - `src/backend/services/llm.service.ts`
    - `src/client/views/parallel-copilot.view/components/GenerationProgressDisplay.tsx`
    - `src/client/views/parallel-copilot.view/components/ResponseTabs.tsx`
    - `src/client/views/parallel-copilot.view/view.scss`
    - `src/common/ipc/channels.type.ts`
- **Total Tokens:** ~15,000
- **More than one cycle?** No
- **Status:** To Do

- [ ] **Task (T-ID: 2.1):** Implement individual timers. Add a `startTime` to each `GenerationProgress` object in `llm.service.ts` and render a separate timer for each response in `GenerationProgressDisplay.tsx`.
- [ ] **Task (T-ID: 2.2):** Implement the "Stop" button to cancel the entire batch request by calling `abort()` on the `AbortController` in `llm.service.ts`.
- [ ] **Task (T-ID: 2.3):** Fix the non-animating spinner icon on the response tabs by correcting the CSS in `view.scss`.
- [ ] **Task (T-ID: 2.4):** Fix the bug where regenerating a single response in the progress view clears all other responses from the UI.

### Verification Steps
1.  Start a new generation.
action taken: started a new test in the same manner as above.
2.  **Expected:** Each response in the progress UI has its own, independently running elapsed timer.
observation: yes, indeed each response has its own individual timer.
3.  Click the "Stop" button.
action taken: clicked the stop button on a generating response
observation: the generating response did not stop. it is still generating.
4.  **Expected:** The vLLM logs should show the request was cancelled, and the UI should stop updating.
observation: the vllm logs did not indicate any stop it still showed it was generating all 4 requests.
5.  **Expected:** The spinner icon on generating tabs should be actively spinning.
observation: spinners are spinning as expected. the only time they spin unexpectedly is when i click re-generate for one of the tabs, then for some reason all the others tabs spinners appear and start to spin as well. they also dont stop when that response comes back, only the expected one stops.
action: on this run, after the test, i then clicked re-generate on resp 1. this time, i do not see the spinner, and i do not see the response ui, but i do see in the vllm that it is processing the request. once the response completed i did see my response view for response 1 update correctly. to test again, went to resp 2 and clicked re-generate. no spinner, but it is processing in vllm. i wonder why i saw the responses in test 1 but not in this test? i followed the same steps in these tests...

## T-3: Code Quality and Documentation
- **Files Involved:**
    - `src/common/types/pcpp.types.ts`
    - `src/client/views/parallel-copilot.view/view.tsx` (and other components)
    - `src/Artifacts/A105. DCE - PCPP View Refactoring Plan for Cycle 76.md` (New)
    - `src/Artifacts/A106. DCE - vLLM Performance and Quantization Guide.md` (New)
- **Total Tokens:** ~12,000 + New Artifacts
- **More than one cycle?** Yes (Refactoring is a future task)
- **Status:** To Do

- [ ] **Task (T-ID: 3.1):** Consolidate the `TabState` interface. Move the definition to `pcpp.types.ts` and update all components to import it from there.
- [ ] **Task (T-ID: 3.2):** Create the new artifact `A105` detailing the plan to refactor `view.tsx`.
- [ ] **Task (T-ID: 3.3):** Create the new artifact `A106` explaining vLLM performance and quantization.