# Artifact A11: DCE - Regression Case Studies
# Date Created: Cycle 16
# Author: AI Model & Curator

- **Key/Value for A0:**
- **Description:** Documents recurring bugs, their root causes, and codified solutions to prevent future regressions during development.
- **Tags:** bugs, regression, troubleshooting, development, best practices

## 1. Purpose

This document serves as a living record of persistent or complex bugs that have recurred across multiple development cycles. By documenting the root cause analysis (RCA) and the confirmed solution for each issue, we create a "source of truth" that can be referenced to prevent the same mistakes from being reintroduced into the codebase.

## 2. Case Studies

---

### Case Study 001: `path.sep` Usage in Frontend Components

-   **Artifacts Affected:** `src/client/components/file-tree/FileTree.tsx`
-   **Cycles Observed:** 13, 14, 16
-   **Symptom:** The webpack build process fails with TypeScript errors similar to the following:
    ```
    [tsl] ERROR in C:\Projects\DCE\src\client\components\file-tree\FileTree.tsx(64,96)
          TS2339: Property 'sep' does not exist on type 'string'.
    ```
-   **Root Cause Analysis (RCA):**
    The error occurs when frontend code (React components running in a webview) attempts to use `path.sep`. The `path` module is a core part of the Node.js runtime environment, and `path.sep` provides the platform-specific path segment separator (`\` for Windows, `/` for POSIX). However, the webview environment is a browser context, not a Node.js context. In the browser, the `path` module does not exist, and attempting to access properties on it results in a TypeScript error and a runtime failure. This mistake typically happens when logic that should be on the backend (like path manipulation) is incorrectly placed in a frontend component.

-   **Codified Solution & Best Practice:**
    1.  **Strict Environment Separation:** All file system path manipulation **must** occur in the backend (the extension host, i.e., files in `src/backend/`). The backend is a Node.js environment and has access to modules like `path` and `fs`.
    2.  **Normalized Paths:** Before sending any file tree data or paths from the backend to the frontend, they should be normalized. The standard practice is to use forward slashes (`/`) as the separator, as this is universally understood by web standards. The backend can use `path.join` and `path.relative` as needed, but the final `FileNode` objects sent to the client should have paths constructed with `/`.
    3.  **Frontend Simplicity:** The frontend code should treat all file paths as simple strings. It should **never** attempt to parse, split, or join them using a path-specific separator. If path segments are needed on the frontend, the backend should provide them pre-split in the data structure.

-   **Example of Incorrect Code (Frontend):**
    ```typescript
    // This is WRONG and will cause the error
    import * as path from 'path';
    const parts = relativePath.split(path.sep);
    ```

-   **Example of Correct Code (Backend):**
    ```typescript
    // src/backend/services/fs.service.ts
    import * as path from 'path';
    // ...
    // When constructing the path for the frontend:
    const relativePath = path.relative(rootPath, file.fsPath).replace(/\\/g, '/'); // Normalize to forward slashes
    ```