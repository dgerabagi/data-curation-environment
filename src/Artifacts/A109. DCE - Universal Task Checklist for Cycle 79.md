# Artifact A109: DCE - Universal Task Checklist for Cycle 79
# Date Created: C79
# Author: AI Model & Curator

## 1. Purpose

This artifact provides a structured checklist for tracking the development tasks and critical bugs identified in Cycle 79. The primary focus is on fixing state management and UI rendering issues related to the response generation and regeneration workflows.

---

## Task List for Cycle 79+

## T-1: Fix State Corruption and Per-Tab View Logic (Highest Priority)
- **Files Involved:**
    - `src/backend/services/llm.service.ts`
    - `src/backend/services/history.service.ts`
    - `src/client/views/parallel-copilot.view/view.tsx`
- **Total Tokens:** ~16,500
- **More than one cycle?** No
- **Status:** To Do

- [ ] **Task (T-ID: 1.1):** In `llm.service.ts`, when the last response in a batch finishes, call a new `historyService.finalizeCycleStatus(cycleId)` method.
- [ ] **Task (T-ID: 1.2):** Implement the `finalizeCycleStatus` method in `history.service.ts` to set the cycle's `status` to `'complete'` and save the history file. This fixes the state corruption on navigation.
- [ ] **Task (T-ID: 1.3):** In `view.tsx`, refactor the main render logic. The decision to render `GenerationProgressDisplay` vs. `ResponsePane` must be based on the status of the *active tab* (`tabs[activeTab]?.status`), not the overall cycle status. This fixes the "stuck generating view" and the broken regeneration UI.

### Verification Steps
1.  Generate a batch of responses. Let them complete.
2.  Navigate to a previous cycle, then navigate back to the cycle with the new responses.
3.  **Expected:** The UI should correctly show the `ResponsePane` and not be stuck in the generating view. `dce_history.json` should show `status: "complete"` for that cycle.
4.  Start a new generation. While it's running, click on a tab for a response that has already completed.
5.  **Expected:** The UI should switch to the `ResponsePane` for the completed tab.
6.  Click the regenerate button on a single tab.
7.  **Expected:** The `GenerationProgressDisplay` should appear correctly for that tab while it regenerates.

## T-2: Refine Regeneration Workflow and Streaming UI
- **Files Involved:**
    - `src/client/views/parallel-copilot.view/components/ResponseTabs.tsx`
    - `src/client/views/parallel-copilot.view/view.tsx`
- **Total Tokens:** ~10,500
- **More than one cycle?** No
- **Status:** To Do

- [ ] **Task (T-ID: 2.1):** Implement the two-step (click -> confirm) regeneration logic in `ResponseTabs.tsx` using local state.
- [ ] **Task (T-ID: 2.2):** Modify the `UpdateGenerationProgress` IPC handler in `view.tsx`. It should only update the `rawContent` and progress data. It must **not** call `parseResponse`.

### Verification Steps
1.  Click the regenerate icon on a tab once.
2.  **Expected:** The icon changes to a checkmark. No request is sent.
3.  Click it again.
4.  **Expected:** The regeneration request is sent.
5.  Start a new generation.
6.  **Expected:** The UI should not flicker with "0 files" or "parsing failed" messages while "thinking" tokens are streaming in.