# Artifact A91: AI Ascent - Caddyfile (Reference)
# Date Created: C29
# Author: AI Model & Curator

- **Key/Value for A0:**
- **Description:** A reference copy of the `Caddyfile` from the `aiascent.game` project, used for configuring the web server proxy.
- **Tags:** reference, configuration, caddy, proxy

## 1. Overview

This artifact contains the literal source code of the `Caddyfile` from the `aiascent.game` project, as provided in Cycle 29. Caddy is a powerful, modern web server that automatically handles HTTPS. This configuration shows how it's used as a reverse proxy to route all traffic for `aiascent.game` to the backend Node.js server running on port 3001.

This configuration is a good reference for setting up a production environment. No changes are needed to it to support the new DCE LLM proxy endpoint, as the existing `reverse_proxy` directive is a catch-all that will correctly forward the new API routes.

## 2. Source Code

```caddy
# Artifact 146: Caddyfile (Production)
# Date Created: Cycle 1188
# Author: AI Model
# Updated on: C1268 (Refactor for production static file serving.)

# This Caddyfile provides a robust configuration for running AI Ascent in a production
# environment. It automatically handles HTTPS, serves the static client application,
# and correctly routes API and WebSocket traffic to the backend Node.js server.

aiascent.game {
    # Caddy will automatically provision and renew a free SSL certificate from Let's Encrypt.
    
    # Enable gzip and zstd compression for better performance.
    encode zstd gzip

    # Log all requests and errors.
    log {
        output file aiascent_caddy.log
    }

    # Reverse proxy ALL incoming requests to the backend Node.js server,
    # which is now responsible for handling API, WebSockets, and serving static files.
    # The `header_up` directives ensure WebSocket connections can be established correctly.
    reverse_proxy localhost:3001 {
        header_up Host {host}
        header_up X-Real-IP {remote_ip}
        header_up X-Forwarded-For {remote_ip}
        header_up X-Forwarded-Proto {scheme}
        header_up Connection {>Connection}
        header_up Upgrade {>Upgrade}
    }
}

# Optional: Redirect www to the main domain
www.aiascent.game {
    redir https://aiascent.game{uri} permanent
}