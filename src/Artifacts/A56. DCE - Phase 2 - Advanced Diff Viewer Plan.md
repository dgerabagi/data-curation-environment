# Artifact A56: DCE - Phase 2 - Advanced Diff Viewer Plan
# Date Created: C120
# Author: AI Model & Curator
# Updated on: C27 (Deprecate custom diff viewer)

- **Key/Value for A0:**
- **Description:** Details the plan to enhance the integrated diff viewer with a side-by-side layout, scroll-locking, keyboard navigation, and a location pane.
- **Tags:** feature plan, phase 2, ui, ux, diff, navigation, side-by-side, scroll-lock, keyboard

## 1. Overview & Goal

**Status (C27):** This custom component has been **deprecated**. It is being replaced by an integration with VS Code's native diff viewer (`vscode.diff`), which provides a superior user experience. See `A88. DCE - Native Diff Integration Plan.md` for the current implementation details.

---
**(Historical Plan)**

The current diff view is functional but lacks key usability features found in mature diff tools like WinMerge. The goal of this plan is to enhance the diff viewer to provide a much clearer and more efficient user experience. This involves several key enhancements:
1.  **Side-by-Side Main Layout:** Displaying the original and modified files in two parallel, vertical panes.
2.  **Top-and-Bottom Detail Layout:** Displaying the character-level diff in two panes stacked vertically at the bottom.
3.  **Scroll-Locking:** Synchronizing the scroll position of the two main panes and the two detail panes, with all four panes having visible scrollbars.
4.  **Keyboard Navigation:** Allowing users to navigate between differences and accept changes using only the keyboard.
5.  **Location Pane (Future):** A visual overview of all changes in the file.

## 2. User Stories (Historical)

| ID | User Story | Acceptance Criteria |
|---|---|---|
| P2-DIFF-01 | **Side-by-Side Diffs** | As a developer, I want to see a side-by-side view of the original and modified code with a colored background for changed lines, so I can immediately identify changes at a glance. | - The main diff view is split into two vertical panes: "Original Workspace File" on the right, "AI Response" on the left. <br> - Lines are colored appropriately for additions and removals. |
| P2-DIFF-02 | **Scroll-Locking** | As a developer, when I scroll one of the main diff panes vertically, I want the other main pane to scroll with it, so I can keep the corresponding code aligned. | - All four diff panes have their own scrollbars. <br> - The two main diff panes are scroll-locked vertically. <br> - The two bottom detail panes are scroll-locked horizontally. |
| P2-DIFF-03 | **Navigate Between Diffs** | As a developer reviewing a large file, I want "Next Difference" and "Previous Difference" buttons, so I can quickly jump between changed blocks. | - "Next Difference" (`↓`) and "Previous Difference" (`↑`) buttons are located in a stable toolbar. <br> - Clicking scrolls the view to the start of the next/previous block of changes and highlights it. |
| P2-DIFF-04 | **Keyboard Navigation & Acceptance** | As a developer, I want to use the up/down arrow keys to navigate between differences and the right arrow key to accept the change from the response, so I can review and merge code without using the mouse. | - Pressing `ArrowDown` selects the next difference block. <br> - Pressing `ArrowUp` selects the previous difference block. <br> - Pressing `ArrowRight` accepts the change from the left (AI) pane, visually updating the right (original) pane's content *in memory*. |
| P2-DIFF-05 | **Location Pane (Future)** | As a developer, I want to see a miniature, vertical map of all the changes in the file, so I can understand the overall scope of the diff and quickly jump to any section. | - A new "Location Pane" is displayed above the main diff view. <br> - It shows a compressed visual representation of the entire file, with colored blocks indicating added, removed, and changed lines. <br> - Clicking on a block in this pane scrolls the main diff view to that location. |
| P2-DIFF-06 | **Line Numbers in Detail Pane (Future)** | As a developer, I want to see line numbers in the bottom character-level diff panes, so I have context for where the detailed change is occurring. | - The bottom panes display the relevant line numbers next to the content. |