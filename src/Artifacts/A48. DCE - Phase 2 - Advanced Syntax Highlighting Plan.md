# Artifact A48: DCE - Phase 2 - Advanced Syntax Highlighting Plan
# Date Created: C82
# Author: AI Model

- **Key/Value for A0:**
- **Description:** Outlines the strategy to replace the plain textarea in response tabs with a proper code editor component to provide rich syntax highlighting for Markdown and embedded code.
- **Tags:** feature plan, phase 2, ui, ux, syntax highlighting, monaco, codemirror

## 1. Overview & Goal

AI-generated responses are complex documents, containing both explanatory Markdown text and code blocks in various languages. A plain `<textarea>` element does not provide any syntax highlighting, making these responses difficult to read and analyze. The goal of this feature is to significantly enhance the readability of AI responses by replacing the textareas with a proper code editor component that can provide rich, language-aware syntax highlighting.

## 2. User Story

| ID | User Story | Acceptance Criteria |
|---|---|---|
| P2-SYNTAX-01 | **View Highlighted Responses** | As a developer, I want to see AI responses with full syntax highlighting inside the Parallel Co-Pilot tabs, so I can easily distinguish between comments, keywords, and code, just like in a real editor. | - The content area of each response tab renders with syntax highlighting. <br> - Standard Markdown elements (headers, lists, bold, italics, backticks) are formatted correctly. <br> - Code blocks (e.g., ` ```typescript ... ``` `) are highlighted with the correct grammar for the specified language. <br> - The editor component should be theme-aware, matching the user's current VS Code theme. |

## 3. Technical Implementation Strategy

### 3.1. Choosing a Library

A simple Markdown renderer is insufficient because it cannot handle language-specific highlighting within code blocks. A full-featured code editor component is required.

-   **Option A: Monaco Editor (`@monaco-editor/react`)**
    -   **Pros:** This is the editor that powers VS Code itself. It provides the most authentic look and feel, supports all the same languages and themes, and is extremely powerful.
    -   **Cons:** It can be heavy and complex to configure within a Webpack-based webview.
-   **Option B: CodeMirror (`@uiw/react-codemirror`)**
    -   **Pros:** More lightweight and modular than Monaco. Excellent language support and theming capabilities. Often easier to integrate into React projects.
    -   **Cons:** The look and feel might not be a 100% perfect match for the native VS Code editor.

-   **Decision:** Start with `react-markdown` with a syntax highlighting plugin (like `rehype-prism-plus`) as an immediate, lightweight improvement. Plan for a future migration to a full editor like CodeMirror or Monaco as the feature set grows. This phased approach balances immediate value with long-term goals.

### 3.2. Implementation Plan (Phase 1: `react-markdown`)

1.  **Dependencies:** Add `react-markdown` and a syntax highlighting plugin (e.g., `rehype-prism-plus` or `react-syntax-highlighter`) to `package.json`.
2.  **Component (`parallel-copilot.view/view.tsx`):**
    *   Create a new component, e.g., `ResponseViewer`.
    *   This component will take the AI response text as a prop.
    *   It will use the `ReactMarkdown` component to render the text.
    *   The renderer will be configured to use the syntax highlighting plugin for code blocks.
    *   The main view will need a toggle to switch between the `ResponseViewer` (read-only) and a `<textarea>` (for editing/pasting).
3.  **Styling:** CSS for the chosen syntax highlighting theme will need to be imported or configured.

### 3.3. Implementation Plan (Phase 2: Full Editor Integration)

1.  **Dependency:** Add the chosen editor library (`@uiw/react-codemirror` or `@monaco-editor/react`) to `package.json`.
2.  **Webpack Configuration:** Adjust `webpack.config.js` to correctly bundle the editor's assets and web workers, which can be complex.
3.  **Component (`parallel-copilot.view/view.tsx`):**
    *   Replace the `textarea`/`ReactMarkdown` toggle with the new editor component.
    *   Configure the editor component to be read-only initially, with a prop to enable editing.
    *   Set the language mode to "markdown".
    *   Configure the theme to match the VS Code theme variables.