# Artifact A23: DCE - Phase 1 - Advanced Interactions (Keyboard & Drag-Drop) Plan
# Date Created: C29
# Author: AI Model
# Updated on: C68 (Add user stories for Copy/Paste)

- **Key/Value for A0:**
- **Description:** Details the requirements for implementing full keyboard navigation, drag-and-drop, and copy-paste file/folder operations within the main file tree view.
- **Tags:** feature plan, keyboard navigation, drag and drop, copy, paste, file operations, accessibility, ux, phase 1

## 1. Overview & Goal

To achieve true feature parity with the native VS Code Explorer and cater to power users, the Data Curation Environment must support advanced interactions. This plan outlines the requirements for three major features: full keyboard navigation, drag-and-drop for file system manipulation, and copy-paste for file duplication.

## 2. User Stories

| ID | User Story | Acceptance Criteria |
|---|---|---|
| AI-01 | **Keyboard Navigation** | As a power user, I want to navigate the file tree using only my keyboard, so I can find, select, and manage files without taking my hands off the keyboard. | - Arrow Up/Down keys move the focus between visible nodes. <br> - Arrow Right on a collapsed folder expands it. <br> - Arrow Left on an open folder collapses it. <br> - `Enter` key opens the focused file or toggles expansion. <br> - `Spacebar` toggles the checkbox of the focused node. |
| AI-02 | **Internal Drag-and-Drop** | As a user, I want to be able to drag a file or folder and drop it into another folder within the DCE view to move it, so I can reorganize my project intuitively. | - Clicking and dragging a file or folder initiates a drag operation. <br> - Dragging over a folder highlights it as a potential drop target. <br> - Dropping a file/folder onto another folder moves the dragged item. <br> - **Validation:** A folder cannot be dropped into itself or one of its own descendants. |
| AI-03 | **External Drag-and-Drop** | As a user, I want to drag a file (e.g., a PDF) from my computer's file explorer or the VS Code Explorer and drop it into a folder in the DCE view to add it to my project, so I can quickly incorporate new assets. | - Dragging a file from the OS or VS Code Explorer and dropping it onto a folder in the DCE view copies that file into the target folder in the workspace. <br> - The file tree automatically refreshes to show the newly added file. |
| AI-04 | **Copy File/Folder** | As a user, I want to press `Ctrl+C` on a focused file or folder in the DCE tree, so I can prepare to create a duplicate of it. | - When a file or folder has keyboard focus, pressing `Ctrl+C` (or `Cmd+C`) stores its path in an internal "clipboard". <br> - There is no immediate visual feedback, mirroring native explorer behavior. |
| AI-05 | **Paste File/Folder** | As a user, after copying a file/folder, I want to press `Ctrl+V` on a target location to paste a copy of it, so I can quickly scaffold new components or back up files. | - Pressing `Ctrl+V` (or `Cmd+V`) triggers the paste operation. <br> - If a folder is focused, the copied item is pasted inside that folder. <br> - If a file is focused, the copied item is pasted into that file's parent directory. <br> - The pasted item is given a unique name (e.g., `original-copy.ts`, `folder-copy (2)`). <br> - Pasting a folder recursively copies all of its contents. <br> - The file tree refreshes to show the newly created item(s). |
| AI-06 | **Hover to Expand Folder** | As a user dragging a file, when I hover over a collapsed folder for a moment, I want it to automatically expand, so I can drop the file into a nested subdirectory without having to cancel the drag operation. | - During a drag operation, hovering over a collapsed folder for ~500ms triggers its expansion. <br> - Moving the mouse away from the folder before the timer completes cancels the expansion. |

## 3. Implementation Status & Notes

### Keyboard Navigation & Internal Drag-Drop
These features are stable and complete. The internal drag-drop includes robust validation to prevent invalid moves.

### External Drag and Drop (De-Prioritized as of C61)

-   **Status:** **On Hold.**
-   **Summary of Attempts:** Multiple approaches were attempted between C54 and C60 to implement file drops from outside the webview (e.g., from the OS or the native VS Code Explorer).
-   **Root Cause of Failure:** Despite correctly implementing the URI-based approach, the drag-and-drop events (`onDrop`, `onDragOver`) failed to fire reliably or at all when dragging from an external source into the webview. The root cause appears to be a complex interaction with VS Code's webview security model, event propagation, and possibly the Workspace Trust feature, which could not be resolved within a reasonable number of cycles.
-   **Path Forward:** This feature is now considered a **tertiary, long-term research goal**. The core functionality of the extension is not dependent on it. For now, users can add new files using the native VS Code Explorer or the "New File..." button in the DCE toolbar.