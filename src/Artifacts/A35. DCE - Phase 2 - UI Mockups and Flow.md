# Artifact A35: DCE - Phase 2 - UI Mockups and Flow
# Date Created: C69
# Author: AI Model
# Updated on: C88 (Integrate metadata display and diff view interaction)

## 1. Overview

This document describes the user interface (UI) and interaction flow for the Parallel Co-Pilot Panel. The design aims for a clear, multi-pane layout that evolves based on user interaction, starting with an overview of associated files and response blocks, and transitioning to a detailed diff view on demand. The entire UI is housed within its own dedicated view in the VS Code Activity Bar and its state is persistent.

## 2. UI Mockup (Textual Description)

This mockup represents the view that appears when the user clicks the Parallel Co-Pilot icon in the Activity Bar.

### 2.1. Default View State

```
+-------------------------------------------------------------------------------------+
| [Parallel Co-Pilot] [Toolbar: Generate Prompt, Settings, etc.]                      |
|-------------------------------------------------------------------------------------|
| Cycle: [ < ] [ C88 ] [ > ]  [ Cycle Title Input: fix ts error, continue... ]        |
|-------------------------------------------------------------------------------------|
| [Cycle Context (Permanent notes for this cycle)] [Ephemeral Context (Temp logs)]   |
| +------------------------------------------------+ +------------------------------+ |
| | Multi-line text area...                        | | Multi-line text area...      | |
| +------------------------------------------------+ +------------------------------+ |
|-------------------------------------------------------------------------------------|
| [ Response 1 (active) ] [ Response 2 ] [ Response 3 ] [ Response 4 ] [ + ]          |
|-------------------------------------------------------------------------------------|
| [METADATA] Tokens: 5.4K | Similarity: 85% | Files: 2 (2 matched ✓)                 |
|-------------------------------------------------------------------------------------|
| [ Response 1 Content Area - Stretches to fill vertical space ]                      |
| | [Associated Files] | [File Blocks]                                              | |
| | +----------------+ | +--------------------------------------------------------+ | |
| | | ✓ src/file1.ts | | | <src/file1.ts>                                         | | |
| | | ✓ src/file2.ts | | | [Swap] [Comment]                                       | | |
| | |                | | | +----------------------------------------------------+ | | |
| | |                | | | | Scrollable code viewer for file1...              | | | |
| | |                | | | +----------------------------------------------------+ | | |
| | |                | | | <src/file2.ts>                                         | | |
| | +----------------+ | +--------------------------------------------------------+ | |
+-------------------------------------------------------------------------------------+
```

### 2.2. Diff View State

This view appears after the user clicks on `✓ src/file1.ts` in the `[Associated Files]` list.

```
+-------------------------------------------------------------------------------------+
| [ ... Same Header and Context Areas as above ... ]                                  |
|-------------------------------------------------------------------------------------|
| [ Response 1 (active) ] [ Response 2 ] [ Response 3 ] [ Response 4 ] [ + ]          |
|-------------------------------------------------------------------------------------|
| [METADATA] Tokens: 5.4K | Similarity: 85% | Files: 2 (2 matched ✓)                 |
|-------------------------------------------------------------------------------------|
| [ Response 1 Content Area - Stretches to fill vertical space ]                      |
| | [Associated Files] | [Diff Viewer for src/file1.ts]                             | |
| | +----------------+ | +--------------------------------------------------------+ | |
| | | ✓ src/file1.ts | | | [Close Diff] [Swap]                                    | | |
| | | ✓ src/file2.ts | | | | [Original: src/file1.ts] | [Response 1 Version]  | | | |
| | |                | | | |--------------------------|-----------------------| | | |
| | |                | | | | Scrollable diff view...  | Scrollable diff view..| | | |
| | |                | | | |                          |                       | | | |
| | +----------------+ | +--------------------------------------------------------+ | |
+-------------------------------------------------------------------------------------+
```

### 2.3. UI Components Breakdown

1.  **Header, Cycle Navigator, Context Areas:** Unchanged. These provide top-level control and context input.

2.  **Metadata Bar (New):**
    *   A new, persistent bar below the tabs.
    *   Displays key metrics for the active response tab: total token count, similarity score (compared to a primary source file), and a count of associated files (e.g., "2 matched ✓", "1 new file ?").

3.  **Tab Content Area:**
    *   This is the main workspace, now a flexible two-pane layout.
    *   **`[Associated Files]`:** A side panel listing all file paths parsed from the response.
        *   A checkmark (`✓`) appears next to files that are successfully found in the user's workspace.
        *   A question mark (`?`) or other indicator appears for files not found (new files).
        *   **This list is the primary control for the main content area.**
    *   **`[File Blocks]` (Default View):** A vertical list of individual file components, each with its own scrollable code viewer and action buttons.
    *   **`[Diff Viewer]` (Active View):** When a user clicks a file in the `[Associated Files]` list, the entire `[File Blocks]` area is replaced by a dedicated Diff Viewer component, showing a side-by-side comparison for that specific file. A "Close Diff" button returns to the `[File Blocks]` view.

## 3. User Interaction Flow

1.  **Paste & Parse:** The user pastes a response. The `[Associated Files]` list populates, and the `[File Blocks]` view appears. The `[Metadata Bar]` updates with token counts and file match status.
2.  **Review:** The user can scroll through the individual file blocks.
3.  **Diff:** The user clicks on `✓ src/file1.ts`. The `[File Blocks]` view is hidden, and the `[Diff Viewer]` for `src/file1.ts` is shown.
4.  **Close Diff:** The user clicks "Close Diff". The `[Diff Viewer]` is hidden, and the `[File Blocks]` view is shown again.
5.  **Test:** The user clicks the `[Swap]` button on either a file block or from within the diff view to test the code.