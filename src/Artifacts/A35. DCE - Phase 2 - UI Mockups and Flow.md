# Artifact A35: DCE - Phase 2 - UI Mockups and Flow
# Date Created: C69
# Author: AI Model
# Updated on: C111 (Reorder left pane, add token/similarity metrics)

## 1. Overview

This document describes the user interface (UI) and interaction flow for the Parallel Co-Pilot Panel. The design is centered around a two-stage workflow: **Input**, followed by a global **Parse** that transforms the entire panel into a **Review & Act** mode.

## 2. UI Mockup (Textual Description)

### 2.1. Main Header

The main header is a single row containing all primary actions.

```
+-------------------------------------------------------------------------------------------------+
| [Parallel Co-Pilot] [ Gen prompt.md ] [ Parse All ] [ Settings ]   [ Number of Responses: [ 4 ] ] |
|-------------------------------------------------------------------------------------------------|```

### 2.2. Cycle & Context Section

This section has two states: expanded (default) and collapsed.

**Expanded State:**
```
| [v] Cycle & Context                                                                 |
| |-----------------------------------------------------------------------------------|
| | Cycle: [ < ] [ C98 ] [ > ] [ + ] [ Cycle Title Input: ... ]                        |
| |-----------------------------------------------------------------------------------|
| | [Cycle Context (Permanent notes)]          [Ephemeral Context (Temp logs)]        |
| | +----------------------------------------+ +------------------------------------+ |
| | | Multi-line text area...                | | Multi-line text area...            | |
| | +----------------------------------------+ +------------------------------------+ |
```

**Collapsed State:**
```
| [>] Cycle & Context         [ < ] [ C98 ] [ > ]                                     |
```

### 2.3. Parsed View

The parsed view uses a **resizable two-pane layout**. The left pane provides summary information and navigation, while the right pane displays the detailed code content.

```
|-------------------------------------------------------------------------------------------------|
| [ Response 1 (active) ] [ Response 2 ] [ ... ]                                                |
|-------------------------------------------------------------------------------------------------|
| [ Left Pane ]<--->[ Right Pane (Code Viewer) ]                                                 |
| |-------------||------------------------------------------------------------------------------| |
| | [v] ASSOCIATED FILES (Clickable)  | | [ File: src/.../view.tsx ] [ Original: 4.1K | New: 4.2K | Sim: 98% ] | |
| | |-------------------------------| | +------------------------------------------------------------------+ | |
| | | [✓] src/.../view.tsx (selected)| | | [ Read-only editor with line numbers and syntax highlighting ] | | |
| | | [✗] src/.../new-file.ts       | | |                                                                  | | |
| |                                   | | +------------------------------------------------------------------+ | |
| | [v] THOUGHTS / RESPONSE           | |                                                                    | |
| | | Rendered Markdown...            | |                                                                    | |
| |                                   | |                                                                    | |
| | [v] COURSE OF ACTION              | |                                                                    | |
| | | Rendered Markdown...            | |                                                                    | |
+-------------------------------------------------------------------------------------------------+
```
*   **Resizable Divider (`<--->`):** The user can click and drag the divider to resize the left and right panes.
*   **Reordered Left Pane (C111):** The "Associated Files" list is now the first item in the left pane for better information hierarchy.
*   **Token/Similarity Metrics (C111):** The right pane's header now displays the token counts for the original and new file versions, along with a similarity score.

## 3. User Interaction Flow

1.  **Load & Parse:** User loads the panel and clicks "Parse All". The UI transforms into the two-pane layout.
2.  **Auto-Diff:** The extension automatically displays a diff for the first valid file in the "Associated Files" list.
3.  **Manual File Selection:** The user clicks on another file in the "Associated Files" list (left pane).
    *   **Action:** The frontend sends a `RequestFileComparison` message to the backend with the file path and the AI-generated content.
    *   The backend reads the workspace file, calculates token counts for both versions, computes a similarity score, and sends this data back.
    *   **UI Update:** The **right pane** updates. Its header shows the new file path and metrics. The code viewer displays the content of the newly selected file.