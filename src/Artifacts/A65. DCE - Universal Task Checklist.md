# Artifact A65: DCE - Universal Task Checklist
# Date Created: C165
# Author: AI Model & Curator
# Updated on: C166 (Add Verification Steps and ID system)

- **Key/Value for A0:**
- **Description:** A universal checklist for organizing development tasks by file, focusing on complexity in terms of token count and estimated cycles for completion.
- **Tags:** process, checklist, task management, planning, workflow

## 1. Purpose

This artifact provides a structured, universal format for tracking development tasks, feedback, and bugs. Unlike cycle-specific trackers, this checklist organizes work by the group of files involved in a given task. It also introduces a simple complexity metric based on the total token count of the affected files and an estimation of whether the task will require more than one development cycle to complete.

This file-centric approach helps in planning and prioritizing work, especially in an AI-assisted development workflow where context size (token count) is a primary constraint.

## 2. How to Use

-   **Group by File Packages:** Create a new `##` section for each logical task or feature. List all the files that are expected to be modified for this task.
-   **Assign an ID:** Give each task package a unique, simple ID (e.g., `T-1`, `T-2`) for easy reference in feedback.
-   **Estimate Complexity:**
    -   Calculate the **Total Tokens** for all files in the package. This gives a quantitative measure of the context size.
    -   Estimate if the task is likely to take **More than one cycle?**. This is a qualitative judgment based on the complexity of the changes required.
-   **List Action Items:** Under each file package, create a checklist of specific actions, bugs to fix, or features to implement.
-   **Add Verification Steps:** After the action items, add a section describing how the curator should test the feature to confirm it is working as expected.
-   **Note on Output Length:** Remember that the maximum output length for a single response is approximately 65,000 tokens. Do not prematurely stop generating files; attempt to complete as many full files as possible within this limit.

---

## Task List

## T-1: PCPP - No Workspace View
- **Files Involved:**
    - `src/backend/services/history.service.ts`
    - `src/client/views/parallel-copilot.view/view.tsx`
- **Total Tokens:** ~10,500
- **More than one cycle?** No

- [x] **Task:** Modify `history.service.ts` to detect when no workspace folder is open.
- [x] **Task:** In the absence of a workspace, return a special state (e.g., `cycleId: -1`).
- [x] **Task:** Update `view.tsx` to conditionally render a "No Folder Opened" message and an "Open Folder" button when it receives the special state.
- [ ] **Task:** Wire the button to the `workbench.action.files.openFolder` command.

### Verification Steps
1.  Close any open workspace in the VS Code Extension Development Host (`File > Close Folder`).
2.  Open the Parallel Co-Pilot Panel.
3.  **Expected:** The panel should display a "No Folder Opened" message and an "Open Folder" button.
4.  Click the "Open Folder" button.
5.  **Expected:** The native VS Code "Open Folder" dialog should appear.

## T-2: Prompt Generation
- **Files Involved:**
    - `src/backend/services/prompt.service.ts`
- **Total Tokens:** ~4,000
- **More than one cycle?** No

- [x] **Bug Fix:** The `<M5. organized artifacts list>` section should be populated from the user's workspace `A0*.md` file, not the extension's internal one.
- [x] **Bug Fix:** When generating a prompt for a past cycle (e.g., Cycle 3 of 5), do not include future cycles (4 and 5) in the `<M6. Cycles>` block.
- [x] **Feature:** Always include the `<Cycle 0>` content (templates) in every generated `prompt.md` to serve as a persistent "Template Archive".

### Verification Steps
1.  In a test project with at least 5 cycles, navigate back to Cycle 3 in the PCPP.
2.  Click "Generate prompt.md".
3.  **Expected:** The generated `prompt.md` should contain `<M6. Cycles>` with entries for Cycle 3, 2, 1, and 0, but NOT 4 or 5. The `<M5>` section should contain the content of the *test project's* A0 file. The `<Cycle 0>` block with templates should be present.

## T-3: File Tree Interactions
- **Files Involved:**
    - `src/client/components/tree-view/TreeView.tsx`
    - `src/backend/services/file-tree.service.ts`
- **Total Tokens:** ~8,000
- **More than one cycle?** No

- [x] **Bug Fix:** When multiple files are selected in the main tree view, pressing the `Delete` key must delete all selected files, not just the focused one.
- [x] **Task:** Add `package-lock.json` to the list of non-selectable files in `file-tree.service.ts`.

### Verification Steps
1.  Open the Context Chooser panel.
2.  **Expected:** The `package-lock.json` file should have a disabled checkbox.
3.  In the file tree, use Ctrl+Click to select multiple files.
4.  Press the `Delete` key.
5.  **Expected:** A single confirmation dialog for all selected files should appear, and confirming it should delete all of them.